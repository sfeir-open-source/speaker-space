<app-navbar-event-page
  [eventUrl]="eventUrl"
  [eventId]="eventId"
  [eventName]="eventName"
  [teamUrl]="teamUrl">
</app-navbar-event-page>

<div class="px-10 sm:px-10 md:px-10 lg:px-10 xl:px-20 2xl:px-70 w-full">
  <main class="flex">
    <app-sidebar-event [eventId]="eventId"></app-sidebar-event>
    <section class="flex-1 p-4">
      @if (isLoading) {
        <div class="flex justify-center items-center h-40" role="status" aria-label="Loading event data">
          <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
          <span class="sr-only">Loading...</span>
        </div>
      }

      @if (error) {
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
          <p>{{ error }}</p>
        </div>
      }

      @if (!isLoading && !error) {
        <article class="w-full items-center bg-white shadow-md rounded-lg mb-5">
          <header class="p-4">
            <h1 class="text-xl font-medium">General</h1>
            <p class="mt-2 text-sm text-gray-600">
              Change event name, URL, and visibility settings
            </p>
          </header>

          <div class="px-4 pb-4">
            <app-general-info-event
              mode="edit"
              [initialData]="eventGeneralData"
              [initialVisibility]="visibility"
              (formSubmitted)="onGeneralFormSubmitted($event)">
            </app-general-info-event>
          </div>
        </article>

        <app-information-event
          mode="edit"
          [initialData]="eventInformationData"
          (formSubmitted)="onInformationFormSubmitted($event)">
        </app-information-event>

        @if (currentUserRole === 'Owner') {
          <app-danger-zone
            [config]="dangerZoneConfig"
            [isDeleting]="isDeleting || isArchiving"
            [currentUserRole]="currentUserRole"
            (archiveAction)="onDangerZoneArchive()"
            (deleteAction)="onDangerZoneDelete()">
          </app-danger-zone>
        }
      }

      <app-archive-event-popup
        [eventName]="eventName"
        [isOpen]="showArchiveConfirmation"
        [isArchiving]="isArchiving"
        (confirm)="archiveEvent()"
        (cancel)="cancelArchiveEvent()">
      </app-archive-event-popup>

      <app-delete-confirmation-popup
        [config]="deleteConfirmationConfig"
        [isOpen]="showDeleteConfirmation"
        [isDeleting]="isDeleting"
        (confirm)="onDeleteConfirmed()"
        (cancel)="onDeleteCancelled()">
      </app-delete-confirmation-popup>
    </section>
  </main>
</div>
